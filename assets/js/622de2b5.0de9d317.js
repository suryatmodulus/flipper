"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7582],{3905:(e,n,a)=>{a.r(n),a.d(n,{MDXContext:()=>p,MDXProvider:()=>u,mdx:()=>v,useMDXComponents:()=>s,withMDXComponents:()=>c});var t=a(67294);function i(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function l(){return l=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e},l.apply(this,arguments)}function r(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(Object(a),!0).forEach((function(n){i(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function d(e,n){if(null==e)return{};var a,t,i=function(e,n){if(null==e)return{};var a,t,i={},l=Object.keys(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||(i[a]=e[a]);return i}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)a=l[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var p=t.createContext({}),c=function(e){return function(n){var a=s(n.components);return t.createElement(e,l({},n,{components:a}))}},s=function(e){var n=t.useContext(p),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},u=function(e){var n=s(e.components);return t.createElement(p.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},g=t.forwardRef((function(e,n){var a=e.components,i=e.mdxType,l=e.originalType,r=e.parentName,p=d(e,["components","mdxType","originalType","parentName"]),c=s(a),u=i,g=c["".concat(r,".").concat(u)]||c[u]||m[u]||l;return a?t.createElement(g,o(o({ref:n},p),{},{components:a})):t.createElement(g,o({ref:n},p))}));function v(e,n){var a=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var l=a.length,r=new Array(l);r[0]=g;var o={};for(var d in n)hasOwnProperty.call(n,d)&&(o[d]=n[d]);o.originalType=e,o.mdxType="string"==typeof e?e:i,r[1]=o;for(var p=2;p<l;p++)r[p]=a[p];return t.createElement.apply(null,r)}return t.createElement.apply(null,a)}g.displayName="MDXCreateElement"},58215:(e,n,a)=>{a.r(n),a.d(n,{default:()=>i});var t=a(67294);const i=function(e){var n=e.children,a=e.hidden,i=e.className;return t.createElement("div",{role:"tabpanel",hidden:a,className:i},n)}},26396:(e,n,a)=>{a.r(n),a.d(n,{default:()=>u});var t=a(83117),i=a(67294),l=a(72389),r=a(79443);const o=function(){var e=(0,i.useContext)(r.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e};var d=a(89521),p=a(86010);const c="tabItem_1uMI";function s(e){var n,a,t,l=e.lazy,r=e.block,s=e.defaultValue,u=e.values,m=e.groupId,g=e.className,v=i.Children.map(e.children,(function(e){if((0,i.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),h=null!=u?u:v.map((function(e){var n=e.props;return{value:n.value,label:n.label}})),f=(0,d.duplicates)(h,(function(e,n){return e.value===n.value}));if(f.length>0)throw new Error('Docusaurus error: Duplicate values "'+f.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var x=null===s?s:null!=(n=null!=s?s:null==(a=v.find((function(e){return e.props.default})))?void 0:a.props.value)?n:null==(t=v[0])?void 0:t.props.value;if(null!==x&&!h.some((function(e){return e.value===x})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+x+'" but none of its children has the corresponding value. Available values are: '+h.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var b=o(),y=b.tabGroupChoices,N=b.setTabGroupChoices,w=(0,i.useState)(x),C=w[0],P=w[1],F=[],T=(0,d.useScrollPositionBlocker)().blockElementScrollPositionUntilNextRender;if(null!=m){var k=y[m];null!=k&&k!==C&&h.some((function(e){return e.value===k}))&&P(k)}var j=function(e){var n=e.currentTarget,a=F.indexOf(n),t=h[a].value;t!==C&&(T(n),P(t),null!=m&&N(m,t))},I=function(e){var n,a=null;switch(e.key){case"ArrowRight":var t=F.indexOf(e.currentTarget)+1;a=F[t]||F[0];break;case"ArrowLeft":var i=F.indexOf(e.currentTarget)-1;a=F[i]||F[F.length-1]}null==(n=a)||n.focus()};return i.createElement("div",{className:"tabs-container"},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,p.default)("tabs",{"tabs--block":r},g)},h.map((function(e){var n=e.value,a=e.label;return i.createElement("li",{role:"tab",tabIndex:C===n?0:-1,"aria-selected":C===n,className:(0,p.default)("tabs__item",c,{"tabs__item--active":C===n}),key:n,ref:function(e){return F.push(e)},onKeyDown:I,onFocus:j,onClick:j},null!=a?a:n)}))),l?(0,i.cloneElement)(v.filter((function(e){return e.props.value===C}))[0],{className:"margin-vert--md"}):i.createElement("div",{className:"margin-vert--md"},v.map((function(e,n){return(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==C})}))))}function u(e){var n=(0,l.default)();return i.createElement(s,(0,t.Z)({key:String(n)},e))}},57916:(e,n,a)=>{a.r(n),a.d(n,{frontMatter:()=>c,contentTitle:()=>s,metadata:()=>u,toc:()=>m,default:()=>v});var t=a(83117),i=a(80102),l=(a(67294),a(3905)),r=a(26396),o=a(58215),d=a(44256),p=["components"],c={id:"create-plugin",title:"Client Plugin API"},s=void 0,u={unversionedId:"extending/create-plugin",id:"extending/create-plugin",isDocsHomePage:!1,title:"Client Plugin API",description:"FlipperPlugin",source:"@site/../docs/extending/create-plugin.mdx",sourceDirName:"extending",slug:"/extending/create-plugin",permalink:"/docs/extending/create-plugin",editUrl:"https://github.com/facebook/flipper/blob/main/website/../docs/extending/create-plugin.mdx",tags:[],version:"current",frontMatter:{id:"create-plugin",title:"Client Plugin API"},sidebar:"extending",previous:{title:"Using Node.js APIs",permalink:"/docs/extending/node-apis"},next:{title:"Error Handling",permalink:"/docs/extending/error-handling"}},m=[{value:"FlipperPlugin",id:"flipperplugin",children:[],level:2},{value:"Using FlipperConnection",id:"using-flipperconnection",children:[],level:2},{value:"Push data to the desktop",id:"push-data-to-the-desktop",children:[{value:"Using a plugin instance to send data",id:"using-a-plugin-instance-to-send-data",children:[{value:"Dependency Injection (Android only)",id:"dependency-injection-android-only",children:[],level:4},{value:"using FlipperClient to obtain a plugin instance",id:"using-flipperclient-to-obtain-a-plugin-instance",children:[],level:4}],level:3},{value:"Bi-directional communication demo",id:"bi-directional-communication-demo",children:[],level:3}],level:2},{value:"Background plugins",id:"background-plugins",children:[],level:2}],g={toc:m};function v(e){var n=e.components,a=(0,i.Z)(e,p);return(0,l.mdx)("wrapper",(0,t.Z)({},g,a,{components:n,mdxType:"MDXLayout"}),(0,l.mdx)("h2",{id:"flipperplugin"},"FlipperPlugin"),(0,l.mdx)("p",null,"The plugin implementation that runs on (mobile) applications is called the ",(0,l.mdx)("em",{parentName:"p"},"client plugin")," in Flipper terminology."),(0,l.mdx)("p",null,"To build a client plugin, implement the ",(0,l.mdx)("inlineCode",{parentName:"p"},"FlipperPlugin")," interface."),(0,l.mdx)("p",null,"The ID that is returned from your implementation needs to match the ",(0,l.mdx)("inlineCode",{parentName:"p"},"name")," defined in your JavaScript counterpart's ",(0,l.mdx)("inlineCode",{parentName:"p"},"package.json"),"."),(0,l.mdx)(r.default,{defaultValue:"android",values:[{label:"Android",value:"android"},{label:"iOS",value:"ios"},{label:"C++",value:"cpp"},{label:"React Native (JS)",value:"rn"},{label:"React (JS)",value:"js"}],mdxType:"Tabs"},(0,l.mdx)(o.default,{value:"android",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-java"},'public class MyFlipperPlugin implements FlipperPlugin {\n  private FlipperConnection mConnection;\n\n  @Override\n  public String getId() {\n    return "MyFlipperPlugin";\n  }\n\n  @Override\n  public void onConnect(FlipperConnection connection) throws Exception {\n    mConnection = connection;\n  }\n\n  @Override\n  public void onDisconnect() throws Exception {\n    mConnection = null;\n  }\n\n  @Override\n  public boolean runInBackground() {\n    return false;\n  }\n}\n'))),(0,l.mdx)(o.default,{value:"ios",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-objc"},'@interface MyFlipperPlugin : NSObject<FlipperPlugin>\n@end\n\n@implementation MyFlipperPlugin\n\n- (NSString*)identifier { return @"MyFlipperPlugin"; }\n- (void)didConnect:(FlipperConnection*)connection {}\n- (void)didDisconnect {}\n- (BOOL)runInBackground {}\n\n@end\n'))),(0,l.mdx)(o.default,{value:"cpp",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-cpp"},'class MyFlipperPlugin : public FlipperPlugin {\npublic:\n  std::string identifier() const override { return "MyFlipperPlugin"; }\n  void didConnect(std::shared_ptr<FlipperConnection> conn) override;\n  void didDisconnect() override;\n  bool runInBackground() override;\n};\n'))),(0,l.mdx)(o.default,{value:"rn",mdxType:"TabItem"},(0,l.mdx)("div",{className:"admonition admonition-warning alert alert--danger"},(0,l.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,l.mdx)("h5",{parentName:"div"},(0,l.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,l.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,l.mdx)("div",{parentName:"div",className:"admonition-content"},(0,l.mdx)("p",{parentName:"div"},"Using Flipper from JavaScript in React Native requires the package ",(0,l.mdx)("a",{parentName:"p",href:"https://www.npmjs.com/package/react-native-flipper"},"react-native-flipper")," to be installed in the hosting application."))),(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-javascript"},"import {addPlugin} from 'react-native-flipper';\n\naddPlugin({\n  getId() {\n    return 'MyFlipperPlugin';\n  },\n  onConnect(connection) {\n    console.log('connected');\n  },\n  onDisconnect() {\n    console.log('disconnected');\n  },\n  runInBackground() {\n    return false;\n  },\n});\n"))),(0,l.mdx)(o.default,{value:"js",mdxType:"TabItem"},(0,l.mdx)("div",{className:"admonition admonition-warning alert alert--danger"},(0,l.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,l.mdx)("h5",{parentName:"div"},(0,l.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,l.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,l.mdx)("div",{parentName:"div",className:"admonition-content"},(0,l.mdx)("p",{parentName:"div"},"Using Flipper from JavaScript in your browser requires the package ",(0,l.mdx)("a",{parentName:"p",href:"https://www.npmjs.com/package/js-flipper"},"js-flipper")," to be installed in the hosting application."))),(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-javascript"},"import {flipperClient} from 'js-flipper';\n\n// We want to import and start flipper client only in development and test modes\n// We want to exclude it from our production build\nlet flipperClientPromise;\nif (process.env.NODE_ENV !== 'production') {\n  flipperClientPromise = import('js-flipper').then(({flipperClient}) => {\n    flipperClient.start('React Tic-Tac-Toe');\n    return flipperClient;\n  });\n}\n\nflipperClientPromise?.then((flipperClient) => {\n  flipperClient.addPlugin({\n    getId() {\n      return 'MyFlipperPlugin';\n    },\n    onConnect(connection) {\n      console.log('connected');\n    },\n    onDisconnect() {\n      console.log('disconnected');\n    },\n    runInBackground() {\n      return false;\n    },\n  });\n});\n")))),(0,l.mdx)("h2",{id:"using-flipperconnection"},"Using FlipperConnection"),(0,l.mdx)("p",null,(0,l.mdx)("inlineCode",{parentName:"p"},"onConnect")," will be called when your plugin becomes active. This will provide a ",(0,l.mdx)("inlineCode",{parentName:"p"},"FlipperConnection")," allowing you to register receivers for desktop method calls and respond with data."),(0,l.mdx)(r.default,{defaultValue:"android",values:[{label:"Android",value:"android"},{label:"iOS",value:"ios"},{label:"C++",value:"cpp"},{label:"React Native (JS)",value:"rn"},{label:"React (JS)",value:"js"}],mdxType:"Tabs"},(0,l.mdx)(o.default,{value:"android",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-java"},'connection.receive("getData", new FlipperReceiver() {\n  @Override\n  public void onReceive(FlipperObject params, FlipperResponder responder) throws Exception {\n    responder.success(\n        new FlipperObject.Builder()\n            .put("data", MyData.get())\n            .build());\n  }\n});\n'))),(0,l.mdx)(o.default,{value:"ios",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-objc"},'@interface MyFlipperPlugin : NSObject<FlipperPlugin>\n@end\n\n@implementation MyFlipperPlugin\n\n- (NSString*)identifier { return @"MyFlipperPlugin"; }\n\n- (void)didConnect:(FlipperConnection*)connection\n{\n  [connection receive:@"getData" withBlock:^(NSDictionary *params, FlipperResponder *responder) {\n    [responder success:@{\n      @"data":[MyData get],\n    }];\n  }];\n}\n\n- (void)didDisonnect {}\n\n@end\n'))),(0,l.mdx)(o.default,{value:"cpp",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-cpp"},'void MyFlipperPlugin::didConnect(std::shared_ptr<FlipperConnection> conn) {\n  conn->receive("getData", [](const folly::dynamic &params,\n                             std::unique_ptr<FlipperResponder> responder) {\n    dynamic response = folly::dynamic::object("data", getMyData());\n    responder->success(response);\n  });\n}\n'))),(0,l.mdx)(o.default,{value:"rn",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-javascript"},"addPlugin({\n  getId() {\n    return 'MyFlipperPlugin';\n  },\n  onConnect(connection) {\n    console.log('connected');\n    connection.receive('getData', (data, responder) => {\n      console.log('incoming data', data);\n      // respond with some data\n      responder.success({\n        ack: true,\n      });\n    });\n  },\n  // ...as-is\n});\n"))),(0,l.mdx)(o.default,{value:"js",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-javascript"},"flipperClient.addPlugin({\n  getId() {\n    return 'MyFlipperPlugin';\n  },\n  onConnect(connection) {\n    console.log('connected');\n    connection.receive('getData', (data) => {\n      console.log('incoming data', data);\n      // return data to send it as a response\n      return {\n        ack: true,\n      };\n    });\n    // Flipper client can also send the data you return from your async functions\n    connection.receive('getDataAsync', async (data) => {\n      console.log('incoming data', data);\n      const myAsyncData = await doAsyncStuff();\n      // return data to send it as a response\n      return {\n        data: myAsyncData,\n      };\n    });\n    // Flipper client catches your exceptions and sends them as an error response to the desktop\n    connection.receive('getErrorData', (data) => {\n      console.log('incoming data', data);\n      throw new Error('Ooops');\n    });\n    // It catches the execptions in your async functions as well\n    connection.receive('getErrorDataAsync', async (data) => {\n      console.log('incoming data', data);\n      const myAsyncData = await doAsyncStuff();\n      if (!myAsyncData) {\n        throw new Error('Ooops! Async data is not there!!!');\n      }\n    });\n  },\n  // ...as-is\n});\n")))),(0,l.mdx)("h2",{id:"push-data-to-the-desktop"},"Push data to the desktop"),(0,l.mdx)("p",null,"You don't have to wait for the desktop to request data. You can also push data directly to the desktop. If the JS plugin subscribes to the same method, it will receive the data."),(0,l.mdx)(r.default,{defaultValue:"android",values:[{label:"Android",value:"android"},{label:"iOS",value:"ios"},{label:"C++",value:"cpp"},{label:"React Native (JS)",value:"rn"},{label:"React (JS)",value:"js"}],mdxType:"Tabs"},(0,l.mdx)(o.default,{value:"android",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-java"},'connection.send("MyMessage",\n    new FlipperObject.Builder()\n        .put("message", "Hello")\n        .build()\n'))),(0,l.mdx)(o.default,{value:"ios",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-objc"},'[connection send:@"getData" withParams:@{@"message":@"hello"}];\n'))),(0,l.mdx)(o.default,{value:"cpp",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-cpp"},'void MyFlipperPlugin::didConnect(std::shared_ptr<FlipperConnection> conn) {\n  dynamic message = folly::dynamic::object("message", "hello");\n  conn->send("getData", message);\n}\n'))),(0,l.mdx)(o.default,{value:"rn",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-javascript"},"addPlugin({\n  getId() {\n    return 'MyFlipperPlugin';\n  },\n  onConnect(connection) {\n    console.log('connected');\n    connection.send('newRow', {message: 'Hello'});\n  },\n  // ...as-is\n});\n"))),(0,l.mdx)(o.default,{value:"js",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-javascript"},"flipperClient.addPlugin({\n  getId() {\n    return 'MyFlipperPlugin';\n  },\n  onConnect(connection) {\n    console.log('connected');\n    connection.send('newRow', {message: 'Hello'});\n  },\n  // ...as-is\n});\n")))),(0,l.mdx)("h3",{id:"using-a-plugin-instance-to-send-data"},"Using a plugin instance to send data"),(0,l.mdx)("p",null,"It is often useful to get an instance of a Flipper plugin to send data to it: Flipper makes this simple with built-in support."),(0,l.mdx)(d.FbInternalOnly,{mdxType:"FbInternalOnly"},(0,l.mdx)("h4",{id:"dependency-injection-android-only"},"Dependency Injection (Android only)"),(0,l.mdx)("p",null,"The preferred method to obtain a plugin instance is to use dependency injection when available.\nFor apps like fb4a that use dependency injection, a Module should have already been created by the 'create-plugin' script.\nThis module will define a Singleton instance of your plugin that gets added to the FlipperClient."),(0,l.mdx)("p",null,"You should use this instance of the plugin, by having it injected into your product code by the DI framework.\nAlternatively, you can modify the plugin's injection module so that it injects a component into the FlipperPlugin.")),(0,l.mdx)("h4",{id:"using-flipperclient-to-obtain-a-plugin-instance"},"using FlipperClient to obtain a plugin instance"),(0,l.mdx)("p",null,"Plugins should be treated as singleton instances as there can only be one ",(0,l.mdx)("inlineCode",{parentName:"p"},"FlipperClient")," and each ",(0,l.mdx)("inlineCode",{parentName:"p"},"FlipperClient")," can only have one instance of a certain plugin. The Flipper API makes this simple by offering a way to get the current client and query it for plugins."),(0,l.mdx)("p",null,"Plugins are identified by the string that their identifier method returns, in this example, 'MyFlipperPlugin'."),(0,l.mdx)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,l.mdx)("h5",{parentName:"div"},(0,l.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,l.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.mdx)("div",{parentName:"div",className:"admonition-content"},(0,l.mdx)("p",{parentName:"div"},"Null checks may be required as plugins may not be initialized, such as in production builds."))),(0,l.mdx)(r.default,{defaultValue:"android",values:[{label:"Android",value:"android"},{label:"iOS",value:"ios"},{label:"C++",value:"cpp"}],mdxType:"Tabs"},(0,l.mdx)(o.default,{value:"android",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-java"},"final FlipperClient client = AndroidFlipperClient.getInstanceIfInitialized(context);\nif (client != null) {\n  final MyFlipperPlugin plugin = client.getPluginByClass(MyFlipperPlugin.class);\n  plugin.sendData(myData);\n}\n"))),(0,l.mdx)(o.default,{value:"ios",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-objc"},'FlipperClient *client = [FlipperClient sharedClient];\nMyFlipperPlugin *myPlugin = [client pluginWithIdentifier:@"MyFlipperPlugin"];\n[myPlugin sendData:myData];\n'))),(0,l.mdx)(o.default,{value:"cpp",mdxType:"TabItem"},(0,l.mdx)("pre",null,(0,l.mdx)("code",{parentName:"pre",className:"language-cpp"},'auto& client = FlipperClient::instance();\nauto myPlugin = client.getPlugin<MyFlipperPlugin>("MyFlipperPlugin");\nif (myPlugin) {\n  myPlugin->sendData(myData);\n}\n')))),(0,l.mdx)("p",null,"In the above snippet, ",(0,l.mdx)("inlineCode",{parentName:"p"},"sendData")," is an example of a method that might be implemented by the Flipper plugin."),(0,l.mdx)("h3",{id:"bi-directional-communication-demo"},"Bi-directional communication demo"),(0,l.mdx)("p",null,"A minimal communication demo for Android and iOS can be found in the 'Sample' project:"),(0,l.mdx)("ul",null,(0,l.mdx)("li",{parentName:"ul"},(0,l.mdx)("a",{parentName:"li",href:"https://github.com/facebook/flipper/blob/main/desktop/plugins/public/example/index.tsx"},"Desktop implementation")),(0,l.mdx)("li",{parentName:"ul"},(0,l.mdx)("a",{parentName:"li",href:"https://github.com/facebook/flipper/blob/main/android/sample/src/debug/java/com/facebook/flipper/plugins/example/ExampleFlipperPlugin.java"},"Android")," / ",(0,l.mdx)("a",{parentName:"li",href:"https://github.com/facebook/flipper/tree/7bd4f80c2570bebb52af3cf49e45fc6130d6a473/iOS/Plugins/FlipperKitExamplePlugin/FlipperKitExamplePlugin"},"iOS"))),(0,l.mdx)("p",null,"For React Native and JavaScript, there is a simple game of Tic Tac Toe:"),(0,l.mdx)("ul",null,(0,l.mdx)("li",{parentName:"ul"},(0,l.mdx)("a",{parentName:"li",href:"https://github.com/facebook/flipper/blob/main/desktop/plugins/public/rn-tic-tac-toe/index.tsx"},"Desktop implementation")),(0,l.mdx)("li",{parentName:"ul"},(0,l.mdx)("a",{parentName:"li",href:"https://github.com/facebook/flipper/tree/main/react-native/ReactNativeFlipperExample"},"React Native implementation")," / ",(0,l.mdx)("a",{parentName:"li",href:"https://github.com/facebook/flipper/tree/main/js/react-flipper-example"},"JavaScript (React) implementation"))),(0,l.mdx)("h2",{id:"background-plugins"},"Background plugins"),(0,l.mdx)("p",null,"In some cases, you may want to provide data to Flipper even when your plugin is not currently active. Returning true in ",(0,l.mdx)("inlineCode",{parentName:"p"},"runInBackground()")," results in ",(0,l.mdx)("inlineCode",{parentName:"p"},"onConnect")," being called as soon as Flipper connects, which enables you to use the connection at any time. For more detals, see the ",(0,l.mdx)("a",{parentName:"p",href:"/docs/extending/client-plugin-lifecycle"},"Client Plugin Lifecycle"),". The advantage of this method is that the desktop plugin can process this data in the background and fire notifications. It also reduces the number of renders and time taken to display the data when the plugin becomes active."),(0,l.mdx)("div",{className:"admonition admonition-warning alert alert--danger"},(0,l.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,l.mdx)("h5",{parentName:"div"},(0,l.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,l.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,l.mdx)("div",{parentName:"div",className:"admonition-content"},(0,l.mdx)("p",{parentName:"div"},"Please note that a background plugin could keep some data in memory until a Flipper connection is available, such as to keep statistics about the app startup process. However, a plugin shouldn't assume it will eventually get a connection, since this depends on whether the user has enabled the plugin on the Desktop side."),(0,l.mdx)("p",{parentName:"div"},"It's important to make sure that unbounded amounts of data are not stored!"))))}v.isMDXComponent=!0}}]);