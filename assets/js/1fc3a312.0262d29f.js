"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5670],{3905:(e,n,t)=>{t.r(n),t.d(n,{MDXContext:()=>p,MDXProvider:()=>u,mdx:()=>x,useMDXComponents:()=>m,withMDXComponents:()=>s});var a=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(){return r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},r.apply(this,arguments)}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function d(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var p=a.createContext({}),s=function(e){return function(n){var t=m(n.components);return a.createElement(e,r({},n,{components:t}))}},m=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},u=function(e){var n=m(e.components);return a.createElement(p.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},f=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,p=d(e,["components","mdxType","originalType","parentName"]),s=m(t),u=i,f=s["".concat(o,".").concat(u)]||s[u]||c[u]||r;return t?a.createElement(f,l(l({ref:n},p),{},{components:t})):a.createElement(f,l({ref:n},p))}));function x(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=f;var l={};for(var d in n)hasOwnProperty.call(n,d)&&(l[d]=n[d]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}f.displayName="MDXCreateElement"},56077:(e,n,t)=>{t.r(n),t.d(n,{frontMatter:()=>l,contentTitle:()=>d,metadata:()=>p,toc:()=>s,default:()=>x});var a=t(83117),i=t(80102),r=(t(67294),t(3905)),o=["components"],l={id:"dev-setup",title:"Development Setup"},d=void 0,p={unversionedId:"extending/dev-setup",id:"extending/dev-setup",isDocsHomePage:!1,title:"Development Setup",description:"IDE",source:"@site/../docs/extending/dev-setup.mdx",sourceDirName:"extending",slug:"/extending/dev-setup",permalink:"/docs/extending/dev-setup",editUrl:"https://github.com/facebook/flipper/blob/main/website/../docs/extending/dev-setup.mdx",tags:[],version:"current",frontMatter:{id:"dev-setup",title:"Development Setup"},sidebar:"extending",previous:{title:"Publishing Your Plugin",permalink:"/docs/tutorial/js-publishing"},next:{title:"Dynamically Loading Plugins",permalink:"/docs/extending/loading-custom-plugins"}},s=[{value:"IDE",id:"ide",children:[{value:"TypeScript",id:"typescript",children:[],level:3},{value:"Android (Java)",id:"android-java",children:[],level:3}],level:2},{value:"Running Flipper from source (recommended)",id:"running-flipper-from-source-recommended",children:[{value:"A note on sparse profiles",id:"a-note-on-sparse-profiles",children:[],level:3},{value:"Startup options",id:"startup-options",children:[],level:3}],level:2},{value:"Guidelines for writing TypeScript",id:"guidelines-for-writing-typescript",children:[],level:2},{value:"Submitting a diff / PR",id:"submitting-a-diff--pr",children:[],level:2}],m=function(e){return function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.mdx)("div",n)}},u=m("OssOnly"),c=m("FbInternalOnly"),f={toc:s};function x(e){var n=e.components,t=(0,i.Z)(e,o);return(0,r.mdx)("wrapper",(0,a.Z)({},f,t,{components:n,mdxType:"MDXLayout"}),(0,r.mdx)("h2",{id:"ide"},"IDE"),(0,r.mdx)(u,{mdxType:"OssOnly"},(0,r.mdx)("p",null,"When developing Flipper plugins, the following IDEs are recommended:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"TypeScript (for Flipper Desktop (plugins)): Visual Studio Code",(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},'Install the "ESLint" (dbaeumer.vscode-eslint) extension from marketplace to enable linting.'),(0,r.mdx)("li",{parentName:"ul"},'Install the "Prettier" (esbenp.prettier-vscode) extension to enable automatic code-formatting.'),(0,r.mdx)("li",{parentName:"ul"},"If for some reason it is not working, the builtin TypeScript extension might be disabled. To enable it, to go to extensions, search for \u201c@builtin typescript\u201d and enable it."))),(0,r.mdx)("li",{parentName:"ul"},"Android Studio (for Android plugins)."),(0,r.mdx)("li",{parentName:"ul"},"XCode (for iOS plugins)."))),(0,r.mdx)(c,{mdxType:"FbInternalOnly"},(0,r.mdx)("h3",{id:"typescript"},"TypeScript"),(0,r.mdx)("p",null,"Flipper Desktop is written in TypeScript.\nUse of the internal 'VSCode @ FB' as your 'go to' IDE is strongly recommended (",(0,r.mdx)("inlineCode",{parentName:"p"},"code-fb"),")."),(0,r.mdx)("p",null,"Make sure to install and enable extensions ",(0,r.mdx)("inlineCode",{parentName:"p"},"[FB-Internal] ESLint Diagnostics")," and ",(0,r.mdx)("inlineCode",{parentName:"p"},"[FB-Internal] Prettier"),". If it's not working, the builtin TypeScript extension might be disabled. To enable it, go to extensions, search for \u201c@builtin typescript\u201d, and enable it."),(0,r.mdx)("h3",{id:"android-java"},"Android (Java)"),(0,r.mdx)("p",null,"IntelliJ is the recommended platform. Focussing on a flipper-enabled app should include the flipper modules as expected."),(0,r.mdx)("p",null,"If you don't have an fbsource checkout (such as Whatsapp Team), you can open Android Studio and import project: ",(0,r.mdx)("inlineCode",{parentName:"p"},"fbsource/xplat/sonar")),(0,r.mdx)("p",null,"If you're having gradle (or other) problems, make sure you're on the latest Android Studio version.")),(0,r.mdx)("h2",{id:"running-flipper-from-source-recommended"},"Running Flipper from source (recommended)"),(0,r.mdx)("p",null,"When developing Flipper plugins, it's strongly recommended to run from Flipper itself from source as well, as this yields the following benefits:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"Automatic transpilation and bundling of loaded plugins: ES6, TypeScript, JSX."),(0,r.mdx)("li",{parentName:"ul"},"Automatic refresh after code changes."),(0,r.mdx)("li",{parentName:"ul"},"React and Redux Dev Tools."),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"/docs/extending/debugging"},"Debugging")," using Chrome Dev Tools or Visual Studio Code."),(0,r.mdx)("li",{parentName:"ul"},"Additional debug information like React warnings and performance metrics.")),(0,r.mdx)("p",null,"Prerequisites for a Flipper development build:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"node \u2265 14"),(0,r.mdx)("li",{parentName:"ul"},"yarn \u2265 1.5"),(0,r.mdx)("li",{parentName:"ul"},"git"),(0,r.mdx)("li",{parentName:"ul"},"watchman")),(0,r.mdx)("p",null,"To run Flipper Desktop from source:"),(0,r.mdx)(u,{mdxType:"OssOnly"},(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/facebook/flipper.git\ncd flipper/desktop\nyarn\nyarn start\n")),(0,r.mdx)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,r.mdx)("h5",{parentName:"div"},(0,r.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,r.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Tip")),(0,r.mdx)("div",{parentName:"div",className:"admonition-content"},(0,r.mdx)("p",{parentName:"div"},"Start with ",(0,r.mdx)("inlineCode",{parentName:"p"},"yarn start --fast-refresh")," for experimental fast refreash.")))),(0,r.mdx)(c,{mdxType:"FbInternalOnly"},(0,r.mdx)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,r.mdx)("h5",{parentName:"div"},(0,r.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,r.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.mdx)("div",{parentName:"div",className:"admonition-content"},(0,r.mdx)("p",{parentName:"div"},"All these steps must be run on a local machine (such as a laptop) and development cannot be done on a Dev Server or OnDemand as Flipper is a desktop application."))),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"fbclone fbsource --sparse tools/scm/sparse/xplat/flipper-js\ncd ~/fbsource/xplat/sonar/desktop\nyarn\nyarn start\n")),(0,r.mdx)("h3",{id:"a-note-on-sparse-profiles"},"A note on sparse profiles"),(0,r.mdx)("p",null,"There is a minimal profile for working with the Flipper JavaScript files in ",(0,r.mdx)("inlineCode",{parentName:"p"},"fbsource")," for plugin Developers. This will drastically reduce the size of your checkout, but\nwon't include the files necessary to, for instance, build and work on mobile apps."),(0,r.mdx)("p",null,"If you have an existing sparse checkout, you can add the Flipper profile with the following:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-sh"},"hg sparse enable tools/scm/sparse/xplat/flipper-js\n")),(0,r.mdx)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.mdx)("div",{parentName:"div",className:"admonition-heading"},(0,r.mdx)("h5",{parentName:"div"},(0,r.mdx)("span",{parentName:"h5",className:"admonition-icon"},(0,r.mdx)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.mdx)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Tips")),(0,r.mdx)("div",{parentName:"div",className:"admonition-content"},(0,r.mdx)("ul",{parentName:"div"},(0,r.mdx)("li",{parentName:"ul"},"Start with ",(0,r.mdx)("inlineCode",{parentName:"li"},"yarn start --fast-refresh")," for an experimental fast refresh."),(0,r.mdx)("li",{parentName:"ul"},"Start with ",(0,r.mdx)("inlineCode",{parentName:"li"},"yarn start --public-build")," to preview changes for public builds.")))),(0,r.mdx)("p",null,"Use VSCode to hack on Flipper."),(0,r.mdx)("p",null,"To make sure ESLint and Prettier are applied correctly, make sure to open either ",(0,r.mdx)("inlineCode",{parentName:"p"},"sonar")," or ",(0,r.mdx)("inlineCode",{parentName:"p"},"sonar/desktop")," as workspace folder in VSCode: ",(0,r.mdx)("inlineCode",{parentName:"p"},"code-fb ~/fbsource/xplat/sonar"),".")),(0,r.mdx)("h3",{id:"startup-options"},"Startup options"),(0,r.mdx)("p",null,"You can use several options to customise development build instance. They can be provided as command-line args or environment variables."),(0,r.mdx)("p",null,"You can check all of them by executing ",(0,r.mdx)("inlineCode",{parentName:"p"},"yarn start --help"),":"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},'yarn start [args]\n\nOptions:\n  --embedded-plugins    Enables embedding of plugins into Flipper bundle. If it\n                        disabled then only installed plugins are loaded. The\n                        flag is enabled by default. Env var\n                        FLIPPER_NO_EMBEDDED_PLUGINS is equivalent to the\n                        command-line option "--no-embedded-plugins".   [Boolean]\n  --fast-refresh        Enable Fast Refresh - quick reload of UI component\n                        changes without restarting Flipper. The flag is disabled\n                        by default. Env var FLIPPER_FAST_REFRESH is equivalent\n                        to the command-line option "--fast-refresh".   [Boolean]\n  --plugin-auto-update  [FB-internal only] Enable plugin auto-updates. The flag\n                        is disabled by default in dev mode. Env var\n                        FLIPPER_NO_PLUGIN_AUTO_UPDATE is equivalent to the\n                        command-line option "--no-plugin-auto-update"  [Boolean]\n  --enabled-plugins     Load only specified plugins and skip loading rest. This\n                        is useful when you are developing only one or few\n                        plugins. Plugins to load can be specified as a\n                        comma-separated list with either plugin id or name used\n                        as identifier, e.g. "--enabled-plugins\n                        network,inspector". The flag is not provided by default\n                        which means that all plugins loaded.             [array]\n  --open-dev-tools      Open Dev Tools window on startup. The flag is disabled\n                        by default. Env var FLIPPER_OPEN_DEV_TOOLS is equivalent\n                        to the command-line option "--open-dev-tools". If\n                        "FLIPPER_UPDATE_DEV_TOOLS=true" is set additionally,\n                        Flipper will try to update the dev tools from the play\n                        store.                                         [Boolean]\n  --dev-server-port     Dev server port. 3000 by default. Env var "PORT=3001" is\n                        equivalent to the command-line option "--dev-server-port\n                        3001".                          [number] [default: 3000]\n  --version             Show version number                            [Boolean]\n  --help                Show help                                      [Boolean]\n')),(0,r.mdx)("p",null,"You can also create an ",(0,r.mdx)("inlineCode",{parentName:"p"},".env")," file in the ",(0,r.mdx)("inlineCode",{parentName:"p"},"desktop")," subfolder and specify any environment variables to load them automatically on ",(0,r.mdx)("inlineCode",{parentName:"p"},"yarn start")," so you don't need to pass command-line args every time:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-bash"},"FLIPPER_FAST_REFRESH=true\nFLIPPER_OPEN_DEV_TOOLS=true\nFLIPPER_ENABLED_PLUGINS=flipper-messages,network,inspector\n")),(0,r.mdx)(c,{mdxType:"FbInternalOnly"},(0,r.mdx)("p",null,"To start Flipper against a specific OnDemand instance, set FB_ONDEMAND flag.  for example, ",(0,r.mdx)("inlineCode",{parentName:"p"},"FB_ONDEMAND=34435.od yarn start"))),(0,r.mdx)("h2",{id:"guidelines-for-writing-typescript"},"Guidelines for writing TypeScript"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"Install 3rd party type definitions as dev dependency (for example, ",(0,r.mdx)("inlineCode",{parentName:"li"},"yarn add @types/lodash --dev"),")")),(0,r.mdx)("h2",{id:"submitting-a-diff--pr"},"Submitting a diff / PR"),(0,r.mdx)("p",null,"Make sure your new functionality is covered with tests and run ",(0,r.mdx)("inlineCode",{parentName:"p"},"yarn test")," or ",(0,r.mdx)("inlineCode",{parentName:"p"},"yarn test --watch")," in the ",(0,r.mdx)("inlineCode",{parentName:"p"},"desktop/")," directory to verify that they pass."),(0,r.mdx)("p",null,"See the ",(0,r.mdx)("a",{parentName:"p",href:"/docs/extending/testing"},"testing")," page for more details on writing and running tests."),(0,r.mdx)("p",null,"To ensure you don't get any lint/formatting errors, run ",(0,r.mdx)("inlineCode",{parentName:"p"},"yarn lint")," before submitting your diff. Some errors (especially formatting errors) can be auto-fixed by running ",(0,r.mdx)("inlineCode",{parentName:"p"},"yarn fix")))}x.isMDXComponent=!0}}]);